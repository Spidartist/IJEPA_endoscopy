INFO:root:VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
INFO:root:making polyp data transforms
INFO:root:Polyp dataset created
INFO:root:Polyp unsupervised data loader created
INFO:root:Using AdamW
INFO:root:Epoch 1
INFO:root:Set up meters for epoch 1
0it [00:00, ?it/s]
INFO:root:Iteration 1
INFO:root:[1,     0] loss: 0.487 masks: 77.0 42.0 [wd: 3.00e-02] [lr: 4.00e-04] [mem: 1.54e+04] (3425.4 ms)
INFO:root:[1,     0] grad_stats: [4.42e-02 1.94e-02] (1.89e-02, 4.82e-02)

1it [00:08,  8.18s/it]
INFO:root:[1,     1] loss: 0.427 masks: 69.0 45.0 [wd: 3.00e-02] [lr: 4.00e-04] [mem: 1.54e+04] (2599.0 ms)
INFO:root:[1,     1] grad_stats: [2.06e-03 1.88e-03] (1.73e-03, 2.84e-03)

2it [00:09,  4.42s/it]
INFO:root:[1,     2] loss: 0.389 masks: 71.0 44.0 [wd: 3.00e-02] [lr: 4.00e-04] [mem: 1.60e+04] (2303.0 ms)
INFO:root:[1,     2] grad_stats: [1.27e-03 6.22e-04] (6.11e-04, 1.90e-03)

4it [00:13,  2.60s/it]
INFO:root:[1,     3] loss: 0.362 masks: 70.5 43.5 [wd: 3.00e-02] [lr: 4.00e-04] [mem: 1.60e+04] (2146.6 ms)
INFO:root:[1,     3] grad_stats: [7.42e-04 2.75e-04] (2.75e-04, 1.03e-03)

5it [00:15,  2.35s/it]
INFO:root:[1,     4] loss: 0.342 masks: 74.6 41.8 [wd: 3.00e-02] [lr: 4.00e-04] [mem: 1.75e+04] (2099.3 ms)
INFO:root:[1,     4] grad_stats: [1.00e-03 2.89e-04] (2.83e-04, 1.34e-03)

6it [00:17,  2.15s/it]
INFO:root:[1,     5] loss: 0.325 masks: 75.0 41.8 [wd: 3.00e-02] [lr: 4.00e-04] [mem: 1.75e+04] (2039.1 ms)
INFO:root:[1,     5] grad_stats: [5.99e-04 1.93e-04] (1.93e-04, 7.06e-04)

7it [00:18,  2.02s/it]
INFO:root:[1,     6] loss: 0.311 masks: 74.3 41.9 [wd: 3.00e-02] [lr: 4.01e-04] [mem: 1.75e+04] (1995.3 ms)
INFO:root:[1,     6] grad_stats: [4.06e-04 1.56e-04] (1.56e-04, 4.66e-04)
INFO:root:Iteration 8
INFO:root:[1,     7] loss: 0.300 masks: 73.1 42.6 [wd: 3.00e-02] [lr: 4.01e-04] [mem: 1.75e+04] (1959.7 ms)
INFO:root:[1,     7] grad_stats: [6.89e-04 1.16e-04] (1.16e-04, 6.89e-04)

8it [00:20,  1.92s/it]
INFO:root:[1,     8] loss: 0.290 masks: 72.7 42.6 [wd: 3.00e-02] [lr: 4.01e-04] [mem: 1.75e+04] (1932.8 ms)
INFO:root:[1,     8] grad_stats: [1.14e-03 1.51e-04] (1.51e-04, 1.14e-03)

9it [00:22,  1.86s/it]
INFO:root:[1,     9] loss: 0.280 masks: 71.6 43.1 [wd: 3.00e-02] [lr: 4.01e-04] [mem: 1.75e+04] (1912.4 ms)
INFO:root:[1,     9] grad_stats: [2.20e-03 2.01e-04] (2.01e-04, 2.20e-03)

10it [00:23,  1.82s/it]
INFO:root:[1,    10] loss: 0.271 masks: 72.3 43.0 [wd: 3.00e-02] [lr: 4.01e-04] [mem: 1.75e+04] (1896.9 ms)
INFO:root:[1,    10] grad_stats: [1.75e-03 2.32e-04] (2.30e-04, 1.75e-03)

11it [00:25,  1.80s/it]
INFO:root:[1,    11] loss: 0.262 masks: 72.9 42.9 [wd: 3.00e-02] [lr: 4.01e-04] [mem: 1.75e+04] (1883.9 ms)
INFO:root:[1,    11] grad_stats: [2.13e-03 6.39e-04] (6.29e-04, 3.31e-03)

13it [00:29,  1.77s/it]
INFO:root:[1,    12] loss: 0.254 masks: 73.0 42.8 [wd: 3.00e-02] [lr: 4.01e-04] [mem: 1.75e+04] (1872.0 ms)
INFO:root:[1,    12] grad_stats: [2.47e-03 3.42e-04] (3.13e-04, 2.47e-03)
13it [00:30,  2.35s/it]
Process Process-1:
Traceback (most recent call last):
  File "/mnt/quanhd/ijepa/src/train_polyp.py", line 321, in forward_target
    rm = calc_rankme(h)
  File "/mnt/quanhd/ijepa/src/helper.py", line 40, in calc_rankme
    _u, s, _vh = torch.linalg.svd(
KeyboardInterrupt
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/mnt/quanhd/env/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/mnt/quanhd/env/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/mnt/quanhd/ijepa/main_polyp.py", line 52, in process_main
    app_main(args=params)
  File "/mnt/quanhd/ijepa/src/train_polyp.py", line 370, in main
    (loss, _new_lr, _new_wd, grad_stats, rm), etime = gpu_timer(train_step)
  File "/mnt/quanhd/ijepa/src/utils/logging.py", line 21, in gpu_timer
    result = closure()
  File "/mnt/quanhd/ijepa/src/train_polyp.py", line 345, in train_step
    h, rm = forward_target()
  File "/mnt/quanhd/ijepa/src/train_polyp.py", line 321, in forward_target
    rm = calc_rankme(h)
  File "/mnt/quanhd/env/lib/python3.9/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 645750) is killed by signal: Interrupt.